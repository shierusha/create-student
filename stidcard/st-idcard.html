<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>學生證</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
<link rel="stylesheet" href="st.css">
</head>
<body>
 <div class="flip-card" id="flipCard">
<div class="flip-card-inner">
      <!-- 正面BG ------------------------------------->
<div class="flip-card-front">
<div  class="container-16-9">
  <img class="bg-img" src="https://shierusha.github.io/school-battle/teachers/img/8.webp" alt="background" />
<!-- 座號 ----------------------------------->
  <div class="student-id">01</div>


<!-- 正面 ----------------------------------->
<div class="imgarea"> 
  <img class="char-img" src="https://shierusha.github.io/create-student/stidcard/img/001.png" alt="角色圖片">
</div>
  
<div class="bigname-box">
  <div class="name-box bigname">佐佐莉・安達亞</div>
</div>
  
<div class="littlename-box">
  <div class="name-box littlename">佐佐莉</div>
</div>

<div class="row">
  <div class="row-1" style="left: 0;">
    <div class="info-box" style="height:7%;">
      <span class="info-label">陣營</span>
      <span class="info-value">白色陣營</span>
    </div>

    <div class="info-box" style="height:7%;">
      <span class="info-label">種族</span>
      <span class="info-value">貓貓的女額</span>
    </div>

    <div class="info-row" style="gap:2%;height:7%;">
      <div class="info-box" style=" width:49%;">
        <span class="info-label">年齡</span>
        <span class="info-value">？</span>
      </div>
      <div class="info-box" style=" width:49%;">
        <span class="info-label">性別</span>
        <span class="info-value">佐佐</span>
      </div>
    </div>

    <div class="info-box" style="height:15%;">
      <span class="info-label">個性</span>
      <span class="info-value" style="margin-top: 0.35em;">貓貓的女額! 香香軟軟 還會給貓貓好多罐罐</span>
  <button class="show-more-btn" style="display:none;">...MORE</button>
    </div>

    <div class="info-box" style="height:7%;">
      <span class="info-label">喜歡</span>
      <span class="info-value">肯定是貓貓!</span>
  <button class="show-more-btn" style="display:none;">...MORE</button>

    </div>

    <div class="info-box" style="height:7%;">
      <span class="info-label">討厭</span>
      <span class="info-value">欺負佐佐的壞人!</span>
  <button class="show-more-btn" style="display:none;">...MORE</button>

    </div>
    <div class="info-box" style="height:7%;border-radius:5px 5px 0px 0px;">
      <span class="info-label">角色備註</span>
      <span style="color: #495079; font-weight: 700;  letter-spacing: 0.05em; padding-left: 0.3em;   align-self: center; ">裏設定</span>
    </div>
    <div class="info-box" style="height:25%;margin-top:-2.8%;border-radius:0px 0px 5px 5px;">
      <span class="info-value"style="margin-top: 0.35em;"># 佐佐超厲害
          # 是貓貓的女額
      </span>
  <button class="show-more-btn" data-title="角色備註/裏設定">...MORE</button>

    </div>   
  </div>

  <div class="row-1" style="right:0;">
    <div class="info-row" style="gap:2%; height:7%;">
      <div class="info-box" style=" width:49%;">
        <span class="info-label">身高</span>
        <span class="info-value">160</span>
      </div>
      <div class="info-box" style=" width:49%;">
        <span class="info-label">體重</span>
        <span class="info-value">50</span>
      </div>
    </div>

    <div class="info-box" style="height:7%;border-radius:5px 5px 0px 0px;">
      <span class="info-label">背景故事</span>
      <span style="color: #495079;
  font-weight: 700;  letter-spacing: 0.05em; padding-left: 0.3em;   align-self: center;">設定</span>
    </div>
    <div class="info-box" style="height:60%;margin-top:-2.8%;border-radius:0px 0px 5px 5px;">
      <span class="info-value"style="margin-top: 0.35em;"># 佐佐超厲害
          # 是貓貓的女額
      </span>
  <button class="show-more-btn" data-title="背景故事/設定">...MORE</button>

    </div> 
  </div>
 <!--  翻面 -->
<div style="
  position: absolute;
  bottom: 0;
  right:0;
  width: 30%;
  height: 10%;
  z-index: 6;
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  align-items: flex-end;
">
  <div class="row-flip-btn" >
    <button class="flip-btn" >
      戰鬥資訊
  <span class="arrow"></span>
  <span class="arrow"></span>

    </button>
  </div>
</div>
  <!--  翻面 -->
</div>
          <!-- 正面 ----------------------------------->
</div>
</div>

<!-- 背面BG -->
<div class="flip-card-back">
<div  class="container-16-9">
  <img class="bg-img" src="https://shierusha.github.io/school-battle/teachers/img/8.webp" alt="background" />
<!-- 座號 ----------------------------------->
  <div class="student-id">89</div>
<!-- 背面 --------------->
<div class="imgarea"> 
  <img class="char-img" src="https://shierusha.github.io/create-student/stidcard/img/089.png" alt="角色圖片">
</div>

<div class="bigname-box">
  <div class="name-box bigname">彼崔爾齊希</div>
</div>
  
<div class="littlename-box">
  <div class="name-box littlename">莫德雷德</div>
</div>

<div class="row" >
  <div class="row-1" style="width: 100%;">
      <div class="info-box" style="height:7%;">
        <span class="info-label">職業</span>
        <span class="info-value">坦</span>
      </div>

      <div class="info-row" style="height:7%;">
        <div class="info-box" style=" width:49.5%;">
          <span class="info-label">屬性</span>
          <span class="info-value">光</span>
        </div>
        <div class="info-box" style=" width:49.5%;">
          <span class="info-label">屬性弱點</span>
          <span class="info-value">無</span>
        </div>
      </div>
      <div class="info-row" style="height:7%;">
        <div class="info-box" style=" width:49.5%;">
          <span class="info-label">定位</span>
          <span class="info-value">近戰攻擊手</span>
        </div>
        <div class="info-box" style=" width:49.5%;">
          <span class="info-label">起始站位</span>
          <span class="info-value">近</span>
        </div>
      </div>
      <div class="info-row" style="gap:0.3%; height:7%; ">
        <div class="info-box" style=" width:43.4%; border-radius: 5px 5px 0px 0px;">
          <span class="info-label">技能</span>
          <span class="info-value">齊希囉囉嗦嗦囉嗦</span>
        </div>
        <div class="info-box" style="width:14%; border-radius: 5px 5px 0px 0px;">
          <span class="info-label">CD</span>
          <span class="info-value">0</span>
        </div>
        <div class="info-box" style="width:42%;  border-radius: 5px 5px 0px 0px;">
          <span class="info-label">效果</span>
          <span class="info-value">範圍(3)</span>
          <span class="info-value">遠近皆可</span>
        </div>
      </div>
      <div class="info-row" style="gap:0.3%;height:27%; margin-top:-1.38%;">
        <div class="info-box" style="width:57.7%;border-radius:0px 0px 0px 5px;">
          <span class="info-label">技能<br>描述</span>
          <span class="info-value">囉囉嗦嗦真的很囉囉嗦嗦</span>
  <button class="show-more-btn" data-title="技能描述">...MORE</button>

        </div>
        <div class="info-box" style="width:42%;border-radius:0px 0px 5px 0px;">
          <span class="info-value">被貓貓嫌棄</span>
  <button class="show-more-btn" style="display:none;">...MORE</button>

        </div>
      </div>
      <div class="info-row" style="gap:0.3%; height:7%; ">
        <div class="info-box" style=" width:43.4%; border-radius: 5px 5px 0px 0px;">
          <span class="info-label">技能</span>
          <span class="info-value">齊希囉囉嗦嗦囉嗦</span>

        </div>
        <div class="info-box" style="width:14%; border-radius: 5px 5px 0px 0px;">
          <span class="info-label">CD</span>
          <span class="info-value">0</span>
        </div>
        <div class="info-box" style="width:42%;  border-radius: 5px 5px 0px 0px;">
          <span class="info-label">效果</span>
          <span class="info-value">範圍(3)</span>
          <span class="info-value">遠近皆可</span>
        </div>
      </div>
      <div class="info-row" style="gap:0.3%;height:27%; margin-top:-1.38%;">
        <div class="info-box" style="width:57.7%;border-radius:0px 0px 0px 5px;">
          <span class="info-label">技能<br>描述</span>
          <span class="info-value">超過13個字就會顯示more</span></span>
  <button class="show-more-btn" data-title="技能描述">...MORE</button>

        </div>
        <div class="info-box" style="width:42%;border-radius:0px 0px 5px 0px;">
          <span class="info-value">超過13個字就會顯示more</span>
  <button class="show-more-btn" style="display:none;">...MORE</button>

        </div>
      </div>
  </div>
</div>
          <!--  背面 -->

</div>
</div>
</div>
</div>
  <!--  背面 -->


<div id="info-modal" class="modal-overlay" style="display:none;">
  <div class="modal-content">
    <div class="modal-header" id="info-modal-title">標題</div>
    <div class="modal-body" id="info-modal-body"></div>
  </div>
</div>



  <script>
    function setNameFontSize(selector, maxChars) {
  document.querySelectorAll(selector).forEach(box => {
    const nameDiv = box.querySelector('.name-box');
    if (!nameDiv) return;
    const fontSize = box.offsetHeight / maxChars * 0.98;
    nameDiv.style.fontSize = fontSize + "px";
  });
}

function fitAllNameBoxes() {
  setNameFontSize('.bigname-box', 12);
  setNameFontSize('.littlename-box', 9);
}

function setInfoBoxFontSize() {
  const infoBoxes = document.querySelectorAll('.info-box');
  if (!infoBoxes.length) return;
  let minHeight = Infinity;
  infoBoxes.forEach(box => {
    const h = box.offsetHeight;
    if (h < minHeight) minHeight = h;
  });
  const fontSize = minHeight * 0.62;
  infoBoxes.forEach(box => {
    box.style.fontSize = fontSize + "px";
  });
}

function setFlipBtnFontSize() {
  document.querySelectorAll('.row-flip-btn').forEach(box => {
    const btn = box.querySelector('.flip-btn');
    if (!btn) return;
    // 用高度算，讓四字不會超出（0.55可微調）
    const fontSize = Math.max(box.offsetHeight * 0.6);
    btn.style.fontSize = fontSize + "px";
  });
}

function setStudentIdFontSize() {
  document.querySelectorAll('.student-id').forEach(box => {
    // 用外層高度計算，數字可依區塊比例微調
    const fontSize = Math.max(box.offsetHeight * 0.7); // 12是最小字體
    box.style.fontSize = fontSize + "px";
  });
}

function fitAll() {
  fitAllNameBoxes();
  setInfoBoxFontSize();
  setFlipBtnFontSize();
  setStudentIdFontSize(); // 新增這行

}

window.addEventListener('DOMContentLoaded', fitAll);
window.addEventListener('resize', fitAll);
window.addEventListener('load', fitAll);






  // 更多
// 判斷 info-value 超過 13 字才顯示 ...MORE
function checkLongTextByCharCount(N = 13) {
  document.querySelectorAll('.info-box').forEach(box => {
    const value = box.querySelector('.info-value');
    const btn = box.querySelector('.show-more-btn');
    if (!value || !btn) return;
    if (value.innerText.trim().length > N) {
      btn.style.display = 'block';
      btn.onclick = function() {
        // 標題優先抓 info-label, 沒有就用 data-title (button自訂)，最後才 "內容"
        const label = this.dataset.title || box.querySelector('.info-label')?.innerText || "效果";
        showInfoModal(label, value.innerHTML);
      }
    } else {
      btn.style.display = 'none';
    }
  });
}
// 初次和視窗大小變動時都要判斷一次
window.addEventListener('DOMContentLoaded', () => checkLongTextByCharCount(13));
window.addEventListener('resize', () => checkLongTextByCharCount(13));


// 彈跳視窗相關
function showInfoModal(title, content) {
  document.getElementById('info-modal-title').innerText = title;
  document.getElementById('info-modal-body').innerHTML = content;
  document.getElementById('info-modal').style.display = 'flex';
}
// 點背景關閉彈窗
document.getElementById('info-modal').addEventListener('click', function(e) {
  if (e.target === this) {
    e.stopPropagation();  // ★★★ 關鍵！阻止觸發 document click
    this.style.display = 'none';
  }
});





window.addEventListener('DOMContentLoaded', () => {
  const flipCard = document.getElementById('flipCard');

  // 點翻面按鈕（阻止冒泡）
  document.querySelectorAll('.flip-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      flipCard.classList.toggle('flipped');
    });
  });

  // 點畫面上非卡片、非彈窗時才翻面
  document.addEventListener('click', (e) => {
    // 判斷 info-modal 是否有顯示
    const modal = document.getElementById('info-modal');
    const isModalOpen = modal && getComputedStyle(modal).display !== 'none';
    // 如果有彈窗開著就不做任何事
    if (isModalOpen) return;
    // 點到非卡片區才翻面
    if (!e.target.closest('#flipCard')) {
      flipCard.classList.toggle('flipped');
    }
  });
});

  </script>
</body>
</html>
